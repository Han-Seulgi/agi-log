<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.agilog.interfaces.ShMapperInterface">
	<select id="getDairyDiaryPhoto" resultType="com.agilog.beans.DailyDiaryPhotoBean">
		<![CDATA[  
			SELECT  DDLIKE, 
					DPCODE, 
					DDCODE, 
					DPLINK
			FROM (SELECT DD_LIKE AS DDLIKE,
						 DP_CODE AS DPCODE,
						 DP_DDCODE AS DDCODE,
					 	 DP_LINK AS DPLINK,
						 DENSE_RANK() OVER(ORDER BY DD_LIKE DESC) AS RANKING
			FROM DP INNER JOIN DD ON DP_DDCODE = DD_CODE AND DP_DDSUCODE = DD_SUCODE 
								  AND DP_DDDATE = DD_DATE
			)
			WHERE RANKING <= 9
		 ]]> 
	</select>
</mapper>