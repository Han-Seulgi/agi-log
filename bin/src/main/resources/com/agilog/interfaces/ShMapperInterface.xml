<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.agilog.interfaces.ShMapperInterface">
	<!-- 대쉬보드 감성일기 사진 불러오기 -->
	<select id="getDairyDiaryPhoto" resultType="com.agilog.beans.DailyDiaryPhotoBean">
		<![CDATA[  
			SELECT  DDLIKE, 
					DPCODE, 
					DDCODE, 
					DPLINK
			FROM (SELECT DD_LIKE AS DDLIKE,
						 DP_CODE AS DPCODE,
						 DP_DDCODE AS DDCODE,
					 	 DP_LINK AS DPLINK,
						 DENSE_RANK() OVER(ORDER BY DD_LIKE DESC) AS RANKING
			FROM DP INNER JOIN DD ON DP_DDCODE = DD_CODE AND DP_DDSUCODE = DD_SUCODE 
								  AND DP_DDDATE = DD_DATE
			)
			WHERE RANKING <= 9
		 ]]> 
	</select>
	
	<!-- 건강일기 아이 나이별 추세 불러오기 -->
	<select id="getHealthStatusList" parameterType="com.agilog.beans.HealthDiaryBean" resultType="com.agilog.beans.HealthDiaryBean">
			SELECT  DENSE_RANK() OVER (ORDER BY AGE DESC) AS RNK,
			        AGE,
			        SUCODE,
			        BBCODE,
			        BBHEIGHT,
			        BBWEIGHT,
			        HEAD
			FROM HEALTHSTATUS 
			WHERE SUCODE = #{suCode} AND BBCODE = #{bbCode}
			ORDER BY AGE DESC
	</select>	
</mapper>